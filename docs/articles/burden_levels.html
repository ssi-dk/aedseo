<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="aedseo">
<title>Seasonal Burden Levels • aedseo</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Seasonal Burden Levels">
<meta property="og:description" content="aedseo">
<meta property="og:image" content="https://ssi-dk.github.io/aedseo/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">aedseo</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/aedseo.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/burden_levels.html">Seasonal Burden Levels</a>
    <a class="dropdown-item" href="../articles/generate_seasonal_wave.html">Simulate Seasonal Epidemic Waves</a>
    <a class="dropdown-item" href="../articles/seasonal_onset.html">Seasonal Epidemic Onset</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ssi-dk/aedseo/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Seasonal Burden Levels</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ssi-dk/aedseo/blob/HEAD/vignettes/burden_levels.Rmd" class="external-link"><code>vignettes/burden_levels.Rmd</code></a></small>
      <div class="d-none name"><code>burden_levels.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ssi-dk/aedseo" class="external-link">aedseo</a></span><span class="op">)</span></span></code></pre></div>
<p>To provide a concise overview of how the
<code><a href="../reference/seasonal_burden_levels.html">seasonal_burden_levels()</a></code> algorithm operates, we utilize the
same example data presented in the <code><a href="../articles/aedseo.html">vignette("aedseo")</a></code>. The
plot below illustrates the two methods available for estimating burden
levels in the <code><a href="../reference/combined_seasonal_output.html">combined_seasonal_output()</a></code> function:</p>
<ul>
<li>
<strong><code>intensity_levels</code></strong>: Intended for
within-season classification of observations.</li>
<li>
<strong><code>peak_levels</code></strong>: Intended for comparing
the height of peaks between seasons.</li>
</ul>
<p>The disease-specific threshold is the <code>very low</code>
breakpoint for both methods. Breakpoints are named as the upper bounds
for the burden levels, and are visualised on following plot.</p>
<p><img src="burden_levels_files/figure-html/unnamed-chunk-2-1.png" width="2187.5"></p>
<div class="section level2">
<h2 id="methodology">Methodology<a class="anchor" aria-label="anchor" href="#methodology"></a>
</h2>
<p>The methodology used to define the burden levels of seasonal
epidemics is based on observations from previous seasons. Historical
data from all available seasons is used to establish the levels for the
current season. This is done by:</p>
<ul>
<li>Using <code>n</code> highest (peak) observations from each
season.</li>
<li>Selecting only observations if they surpass the disease-specific
threshold.</li>
<li>Weighting the observations such that recent observations have a
greater influence than older observations.</li>
<li>A proper distribution (log-normal, weibull and exponential are
currently implemented) is fitted to the weighted <code>n</code> peak
observations. The selected distribution with the fitted parameters is
used to calculate percentiles to be used as breakpoints.</li>
<li>Burden levels can be defined by two methods:
<ul>
<li>
<code>peak_levels</code> which models the height of the seasonal
peaks. Using the log-normal distribution without weights is similar to
the default in <a href="https://github.com/lozalojo/mem" class="external-link">mem</a>.</li>
<li>
<code>intensity_levels</code> which models the within season levels.
The highest breakpoint is identical with the <code>peak_levels</code>
method. Intermediate breakpoints are evenly distributed on a logaritmic
scale, between the <code>very low</code> and <code>high</code>
breakpoints, to give the same relative difference between the
breakpoints.</li>
</ul>
</li>
</ul>
<p>The model is implemented in the <code><a href="../reference/seasonal_burden_levels.html">seasonal_burden_levels()</a></code>
function of the <code>aedseo</code> package. In the following sections
we will describe the arguments for the function and how the model is
build.</p>
<div class="section level4">
<h4 id="peak-observations">Peak observations<a class="anchor" aria-label="anchor" href="#peak-observations"></a>
</h4>
<p>The <code>n_peak</code> argument defines the number of highest
observations to be included from each season. The default of
<code>n_peak</code> is <code>6</code> - corresponding with the
<code>mem</code> defaults of using 30 observations across the latest
five seasons.</p>
</div>
<div class="section level4">
<h4 id="weighting">Weighting<a class="anchor" aria-label="anchor" href="#weighting"></a>
</h4>
<p>The <code>decay_factor</code> argument is implemented to give more
weight to recent seasons, as they are often more indicative of current
and future trends. As time progresses, the relevance of older seasons
may decrease due to changes in factors like testing recommendations,
population immunity, virus mutations, or intervention strategies.
Weighting older seasons less reflects this reduced relevance. From
time-series analysis, <span class="math inline">\(\frac{1}{1-\text{decay_factor}}\)</span> is often
used as an approximate “effective memory”. Hence, with the default
<code>decay_factor</code> = 0.8 the effective memory is five seasons.
(See mentioned by <a href="https://otexts.com/fpp3/ses.html#ses" class="external-link">Hyndman
&amp; Athanasopoulos</a> for an introduction to simple exponential
smoothing) The default <code>decay_factor</code> allows the model to be
responsive to recent changes without being overly sensitive to
short-term fluctuations. The optimal <code>decay_factor</code> can vary
depending on the variability and trends within the data. For datasets
where seasonal patterns are highly stable, a higher
<code>decay_factor</code> (i.e. longer memory) may be appropriate.
Conversely, if the data exhibit dramatic shifts from one season to the
next, a lower <code>decay_factor</code> may improve predictions.</p>
</div>
<div class="section level4">
<h4 id="distribution-and-optimisation">Distribution and optimisation<a class="anchor" aria-label="anchor" href="#distribution-and-optimisation"></a>
</h4>
<p>The <code>family</code> argument is used to select which distribution
the <code>n_peak</code> observations should be fitted to, users can
choose between <code>lnorm</code>, <code>weibull</code> and
<code>exp</code> distributions. The log-normal distribution
theoretically aligns well with the nature of epidemic data, which often
exhibits multiplicative growth patterns. In our optimisation process, we
evaluated the distributions to determine their performance in fitting
Danish non-sentinel cases and hospitalisation data for RSV, SARS-CoV-2
and Influenza (A and B). All three distributions had comparable weighted
likelihood values during optimisation, hence we did not see any
statistical significant difference in their performance.</p>
<p>The model uses the <code><a href="../reference/fit_percentiles.html">fit_percentiles()</a></code> function which
employs the <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">stats::optim</a></code> for estimating the parameters that
maximizes the weighted likelihood. The <code>optim_method</code>
argument can be passed to <code><a href="../reference/seasonal_burden_levels.html">seasonal_burden_levels()</a></code>, default
is <code>Nelder-Mead</code> but other methods can be selected, see
<code><a href="../reference/fit_percentiles.html">?fit_percentiles</a></code>.</p>
</div>
<div class="section level4">
<h4 id="burden-levels">Burden levels<a class="anchor" aria-label="anchor" href="#burden-levels"></a>
</h4>
<p>The <code>method</code> argument is used to select one of the two
methods <code>intensity_levels</code>(default) and
<code>peak_levels</code>. Both methods return percentile(s) from the
fitted distribution which are used to define the breakpoins for the
burden levels. Breakpoints are named <code>very low</code>,
<code>low</code>, <code>medium</code> and <code>high</code> and define
the upper bound of the corresponding burden level.</p>
<ul>
<li><p><code>intensity_levels</code> takes one percentile as argument,
representing the highest breakpoint. The default is set at a 95%
percentile. The disease-specific threshold determines the
<code>very low</code> breakpoint. The <code>low</code> and
<code>medium</code> breakpoints are calculated to give identical
relative increases between the <code>very low</code> and
<code>high</code> breakpoints.</p></li>
<li><p><code>peak_levels</code> takes three percentiles as argument,
representing the <code>low</code>, <code>medium</code> and
<code>high</code> breakpoints. The default percentiles are 40%, 90%, and
97.5% to align with the parameters used in <code>mem</code>. The
disease-specific threshold defines the <code>very low</code>
breakpoint.</p></li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="applying-the-seasonal_burden_levels-algorithm">Applying the <code>seasonal_burden_levels()</code> algorithm<a class="anchor" aria-label="anchor" href="#applying-the-seasonal_burden_levels-algorithm"></a>
</h2>
<p>The same data is created with following combinations:</p>
<ul>
<li>noise</li>
<li>noise and positive trend</li>
<li>noise and negative trend</li>
</ul>
<p>These combinations are selected as it is realistic for real world
data to have noise, and differentiation between trend can occur
declining or inclining between seasons. Breakpoints for season
<em>2024/2025</em> are calculated based on the three previous
seasons.</p>
<p>To apply the <code><a href="../reference/seasonal_burden_levels.html">seasonal_burden_levels()</a></code> algorithm, data
needs to be transformed into a <code>tsd</code> object. The
disease-specific threshold is determined for all data combinations with
use of the method described in <code><a href="../articles/aedseo.html">vignette("aedseo")</a></code>. The
disease-specific threshold should be revised before a new season starts,
especially if the data has a trend.
<img src="burden_levels_files/figure-html/unnamed-chunk-3-1.png" width="3000"></p>
<div class="section level3">
<h3 id="use-the-intensity_levels-method">Use the intensity_levels method<a class="anchor" aria-label="anchor" href="#use-the-intensity_levels-method"></a>
</h3>
<p>The <code><a href="../reference/seasonal_burden_levels.html">seasonal_burden_levels()</a></code> function provides a
<code>tsd_burden_level</code> object, which can be used in the
<code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> S3 method. This provides a concise summary of
your comprehensive seasonal burden level analysis, including breakpoints
for the current season.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">intensity_levels_n</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/seasonal_burden_levels.html">seasonal_burden_levels</a></span><span class="op">(</span></span>
<span>  tsd <span class="op">=</span> <span class="va">tsd_data_noise</span>,</span>
<span>  disease_threshold <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"intensity_levels"</span>,</span>
<span>  conf_levels <span class="op">=</span> <span class="fl">0.975</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">intensity_levels_n</span><span class="op">)</span></span>
<span><span class="co">#&gt; Summary of tsd_burden_levels object</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     Breakpoint estimates:</span></span>
<span><span class="co">#&gt;       very low : 10.000000</span></span>
<span><span class="co">#&gt;       low: 53.267535</span></span>
<span><span class="co">#&gt;       medium: 283.743033</span></span>
<span><span class="co">#&gt;       high: 1511.429206</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     The season for the burden levels:</span></span>
<span><span class="co">#&gt;       2025/2026</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     Model settings:</span></span>
<span><span class="co">#&gt;       Disease specific threshold: 10</span></span>
<span><span class="co">#&gt;       Called using distributional family: lnorm</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="use-the-peak_levels-method">Use the peak_levels method<a class="anchor" aria-label="anchor" href="#use-the-peak_levels-method"></a>
</h3>
<p><code>mem</code> uses the <code>n</code> highest observations from
each previous epidemic period to fit the parameters of the distribution,
where <code>n = 30/seasons</code>. The data has four previous seasons,
to align with mem, we use <code>n_peak = 8</code></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">peak_levels_n</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/seasonal_burden_levels.html">seasonal_burden_levels</a></span><span class="op">(</span></span>
<span>  tsd <span class="op">=</span> <span class="va">tsd_data_noise</span>,</span>
<span>  disease_threshold <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"peak_levels"</span>,</span>
<span>  conf_levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.4</span>, <span class="fl">0.9</span>, <span class="fl">0.975</span><span class="op">)</span>,</span>
<span>  n_peak <span class="op">=</span> <span class="fl">8</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">peak_levels_n</span><span class="op">)</span></span>
<span><span class="co">#&gt; Summary of tsd_burden_levels object</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     Breakpoint estimates:</span></span>
<span><span class="co">#&gt;       very low : 10.000000</span></span>
<span><span class="co">#&gt;       low: 1133.397742</span></span>
<span><span class="co">#&gt;       medium: 1366.530366</span></span>
<span><span class="co">#&gt;       high: 1484.312479</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     The season for the burden levels:</span></span>
<span><span class="co">#&gt;       2025/2026</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     Model settings:</span></span>
<span><span class="co">#&gt;       Disease specific threshold: 10</span></span>
<span><span class="co">#&gt;       Called using distributional family: lnorm</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="compare-intensity_levels-peak_levels-and-mem-algorithms">Compare intensity_levels, peak_levels and mem algorithms<a class="anchor" aria-label="anchor" href="#compare-intensity_levels-peak_levels-and-mem-algorithms"></a>
</h2>
<p><a href="https://github.com/lozalojo/mem" class="external-link">mem</a> is run with default
arguments.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Remove current season such as previous seasons predict for newest season</span></span>
<span><span class="va">previous_seasons</span> <span class="op">&lt;-</span> <span class="va">tsd_data_all</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>season <span class="op">=</span> <span class="fu"><a href="../reference/epi_calendar.html">epi_calendar</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">season</span> <span class="op">!=</span> <span class="st">"2024/2025"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">season</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Run mem algorithm</span></span>
<span><span class="va">mem_thresholds</span> <span class="op">&lt;-</span> <span class="va">previous_seasons</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">Data</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_map.html" class="external-link">group_modify</a></span><span class="op">(</span><span class="op">~</span> <span class="op">{</span></span>
<span>    <span class="va">mem_data</span> <span class="op">&lt;-</span> <span class="va">.x</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>season <span class="op">=</span> <span class="fu">aedseo</span><span class="fu">::</span><span class="fu"><a href="../reference/epi_calendar.html">epi_calendar</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span>,</span>
<span>                    week <span class="op">=</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/week.html" class="external-link">isoweek</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">time</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">season</span>, values_from <span class="op">=</span> <span class="va">observation</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">week</span><span class="op">)</span></span>
<span>    <span class="co"># Run mem</span></span>
<span>    <span class="va">mem_result</span> <span class="op">&lt;-</span> <span class="fu">mem</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mem/man/memmodel.html" class="external-link">memmodel</a></span><span class="op">(</span><span class="va">mem_data</span><span class="op">)</span></span>
<span>    <span class="co"># Extract thresholds</span></span>
<span>    <span class="va">mem_thresholds</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>      `epidemic threshold \n (mem)` <span class="op">=</span> <span class="va">mem_result</span><span class="op">$</span><span class="va">epidemic.thresholds</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>      `medium` <span class="op">=</span> <span class="va">mem_result</span><span class="op">$</span><span class="va">intensity.thresholds</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>      `high` <span class="op">=</span> <span class="va">mem_result</span><span class="op">$</span><span class="va">intensity.thresholds</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>      `very high` <span class="op">=</span> <span class="va">mem_result</span><span class="op">$</span><span class="va">intensity.thresholds</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="aedseo-and-mem-levels">aedseo and mem levels<a class="anchor" aria-label="anchor" href="#aedseo-and-mem-levels"></a>
</h3>
<p><img src="burden_levels_files/figure-html/unnamed-chunk-9-1.png" width="3000"></p>
<p>In the plots:</p>
<ul>
<li>Observations below 3 are filtered out to improve visualization.</li>
<li>y scale is log transformed.</li>
</ul>
<p>Upon examining all methods and data combinations, it becomes clear
that the <code>intensity_levels</code> approach establishes levels
covering the entire set of observations from previous seasons. In
contrast, the <code>peak_levels</code> and <code>mem</code> methods
define levels solely based on the highest observations within each
season, and are thus only relevant for comparing the height of peaks
between seasons.</p>
<p>The highest observations for the <em>2024/2025</em> season for each
data set are:</p>
<table class="table">
<thead><tr class="header">
<th>Data</th>
<th>Observation</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Noise</td>
<td>1466</td>
</tr>
<tr class="even">
<td>Noise and positive trend</td>
<td>1967</td>
</tr>
<tr class="odd">
<td>Noise and negative trend</td>
<td>171</td>
</tr>
</tbody>
</table>
<p>In relation to these highest observations and upon further
examination, we observe the following:</p>
<p>Plots with Noise and Noise with Positive Trend:</p>
<ul>
<li>Both <code>peak_levels</code> and <code>mem</code> estimate very
high breakpoints. This occurs because observations remain consistently
elevated across all three seasons, causing these methods to overlook the
remaining observations.</li>
</ul>
<p>Data with Noise and Positive Trend:</p>
<ul>
<li>All three methods exhibit higher breakpoints, indicating that they
successfully capture the exponentially increasing trend between
seasons.</li>
</ul>
<p>Data with Noise and Negative Trend:</p>
<ul>
<li><p>As observations exponentially decrease between seasons (with the
highest observation this season being 171), we expect the breakpoints to
be the lowest of these examples. This expectation is met across all
three methods. However, the weighting of seasons in
<code>intensity_levels</code> and <code>peak_levels</code> leads to
older seasons having less impact on the breakpoints, as we progress
forward in time. On the other hand, <code>mem</code> includes all high
observations from the previous 10 seasons without diminishing the
importance of older seasons, which results in sustained very high
breakpoints.</p></li>
<li><p>Notably, in the <code>mem</code> method, the epidemic threshold
is positioned slightly above the <code>medium</code> burden level. This
means that the epidemic period begins only when observations reach the
height of the seasonal peaks observed in previous seasons.</p></li>
</ul>
<p>In conclusion, the <code>peak_levels</code> and <code>mem</code>
methods allows us to compare the height of peaks between seasons,
whereas the <code>intensity_levels</code> method supports continuous
monitoring of observations in the current season.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Sofia Myrup Otero, Kasper Schou Telkamp, Lasse Engbo Christiansen, <a href="https://www.ssi.dk/" class="external-link"><img src="https://www.ssi.dk/assets/images/ssi-logo-optimeret.svg" alt="SSI" height="16" style="margin-bottom: 3px;"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
