<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Compute burden levels from seasonal time series observations of current season. — seasonal_burden_levels • aedseo</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Compute burden levels from seasonal time series observations of current season. — seasonal_burden_levels"><meta name="description" content="This function estimates the burden levels of time series observations that are stratified by season.
It uses the previous seasons to estimate the levels of the current season.
The output is results regarding the current season in the time series observations.
NOTE: The data must include data for a complete previous season to make predictions for the current season.
Observations will be incidence if population and incidence are available in the tsd object."><meta property="og:description" content="This function estimates the burden levels of time series observations that are stratified by season.
It uses the previous seasons to estimate the levels of the current season.
The output is results regarding the current season in the time series observations.
NOTE: The data must include data for a complete previous season to make predictions for the current season.
Observations will be incidence if population and incidence are available in the tsd object."><meta property="og:image" content="https://ssi-dk.github.io/aedseo/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">aedseo</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/aedseo.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/burden_levels.html">Seasonal Burden Levels</a></li>
    <li><a class="dropdown-item" href="../articles/generate_seasonal_wave.html">Simulate Seasonal Epidemic Waves</a></li>
    <li><a class="dropdown-item" href="../articles/multiple_waves.html">Multiple waves</a></li>
    <li><a class="dropdown-item" href="../articles/seasonal_onset.html">Seasonal Epidemic Onset</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ssi-dk/aedseo/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Compute burden levels from seasonal time series observations of current season.</h1>
      <small class="dont-index">Source: <a href="https://github.com/ssi-dk/aedseo/blob/v1.0.1/R/seasonal_burden_levels.R" class="external-link"><code>R/seasonal_burden_levels.R</code></a></small>
      <div class="d-none name"><code>seasonal_burden_levels.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function estimates the burden levels of time series observations that are stratified by season.
It uses the previous seasons to estimate the levels of the current season.
The output is results regarding the current season in the time series observations.
NOTE: The data must include data for a complete previous season to make predictions for the current season.
Observations will be incidence if <code>population</code> and <code>incidence</code> are available in the <code>tsd</code> object.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">seasonal_burden_levels</span><span class="op">(</span></span>
<span>  <span class="va">tsd</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lnorm"</span>, <span class="st">"weibull"</span>, <span class="st">"exp"</span><span class="op">)</span>,</span>
<span>  season_start <span class="op">=</span> <span class="fl">21</span>,</span>
<span>  season_end <span class="op">=</span> <span class="va">season_start</span> <span class="op">-</span> <span class="fl">1</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"intensity_levels"</span>, <span class="st">"peak_levels"</span><span class="op">)</span>,</span>
<span>  conf_levels <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  decay_factor <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  disease_threshold <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  n_peak <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  only_current_season <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-tsd">tsd<a class="anchor" aria-label="anchor" href="#arg-tsd"></a></dt>
<dd><p>A <code>tsd</code> object containing time series data</p></dd>


<dt id="arg-family">family<a class="anchor" aria-label="anchor" href="#arg-family"></a></dt>
<dd><p>A character string specifying the family for modeling. Choose between 'poisson', or 'quasipoisson'.
Must be one of: character, family-generator, or family object.</p></dd>


<dt id="arg-season-start-season-end">season_start, season_end<a class="anchor" aria-label="anchor" href="#arg-season-start-season-end"></a></dt>
<dd><p>Integers giving the start and end weeks of the seasons to
stratify the observations by.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>A character string specifying the model to be used in the level calculations.
Both model predict the levels of the current series of observations.</p><ul><li><p><code>intensity_levels</code>: models the risk compared to what has been observed in previous seasons.</p></li>
<li><p><code>peak_levels</code>: models the risk compared to what has been observed in the <code>n_peak</code> observations each season.</p></li>
</ul></dd>


<dt id="arg-conf-levels">conf_levels<a class="anchor" aria-label="anchor" href="#arg-conf-levels"></a></dt>
<dd><p>A numeric vector specifying the confidence levels for parameter estimates. The values have
to be unique and in ascending order, (i.e. the lowest level is first and highest level is last).
The <code>conf_levels</code> are specific for each method:</p><ul><li><p>for <code>intensity_levels</code> only specify the highest confidence level e.g.: <code>0.95</code>, which is the highest intensity
that has been observed in previous seasons.</p></li>
<li><p>for <code>peak_levels</code> specify three confidence levels e.g.: <code>c(0.4, 0.9, 0.975)</code>, which are the three confidence
levels low, medium and high that reflect the peak severity relative to those observed in previous seasons.</p></li>
</ul></dd>


<dt id="arg-decay-factor">decay_factor<a class="anchor" aria-label="anchor" href="#arg-decay-factor"></a></dt>
<dd><p>A numeric value between 0 and 1, that specifies the weight applied to previous seasons in level
calculations. It is used as <code>decay_factor</code>^(number of seasons back), whereby the weight for the most recent season
will be <code>decay_factor</code>^0 = 1. This parameter allows for a decreasing weight assigned to prior seasons, such that
the influence of older seasons diminishes exponentially.</p></dd>


<dt id="arg-disease-threshold">disease_threshold<a class="anchor" aria-label="anchor" href="#arg-disease-threshold"></a></dt>
<dd><p>A number specifying the threshold for considering a disease outbreak. Should be given as incidence if
<code>population</code> and <code>incidence_denominator</code> are in the <code>tsd</code> object else as cases. It defines the per time-step disease threshold that has to be surpassed for the observation to be
included in the level calculations.</p></dd>


<dt id="arg-n-peak">n_peak<a class="anchor" aria-label="anchor" href="#arg-n-peak"></a></dt>
<dd><p>A numeric value specifying the number of peak observations to be selected from each season in the
level calculations. The <code>n_peak</code> observations have to surpass the <code>disease_threshold</code> to be included.</p></dd>


<dt id="arg-only-current-season">only_current_season<a class="anchor" aria-label="anchor" href="#arg-only-current-season"></a></dt>
<dd><p>Should the output only include results for the current season?</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Arguments passed to the <code><a href="fit_percentiles.html">fit_percentiles()</a></code> function.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>tsd_burden_levels</code> object containing:</p><ul><li><p>'season': The season that burden levels are calculated for.</p></li>
<li><p>'high_conf_level': (only for intensity_level method) The conf_level chosen for the high level.</p></li>
<li><p>'conf_levels': (only for peak_level method) The conf_levels chosen to fit the 'low', 'medium', 'high' levels.</p></li>
<li><p>'values': A named vector with values for 'very low', 'low', 'medium', 'high' levels.</p></li>
<li><p>'optim' A list containing:</p><ul><li><p>'par': The fit parameters for the chosen family.</p><ul><li><p>par_1:</p><ul><li><p>For 'weibull': Shape parameter.</p></li>
<li><p>For 'lnorm': Mean of the log-transformed observations.</p></li>
<li><p>For 'exp': Rate parameter.</p></li>
</ul></li>
<li><p>'par_2':</p><ul><li><p>For 'weibull': Scale parameter.</p></li>
<li><p>For 'lnorm': Standard deviation of the log-transformed observations.</p></li>
<li><p>For 'exp': Not applicable (set to NA).</p></li>
</ul></li>
</ul></li>
<li><p>'obj_value': The value of the objective function - (negative log-likelihood), which represent the minimised
objective function value from the optimisation. Smaller value equals better optimisation.</p></li>
<li><p>'converged': Logical. TRUE if the optimisation converged.</p></li>
<li><p>'family': The distribution family used for the optimization.</p><ul><li><p>'weibull': Uses the Weibull distribution for fitting.</p></li>
<li><p>'lnorm': Uses the Log-normal distribution for fitting.</p></li>
<li><p>'exp': Uses the Exponential distribution for fitting.</p></li>
</ul></li>
</ul></li>
<li><p>'disease_threshold': The input disease threshold, which is also the very low level.</p></li>
<li><p>'incidence_denominator': The observations per incidence-denominator.</p></li>
<li><p>Attributes: <code>time_interval</code> and <code>incidence_denominator</code>.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Generate random flu season</span></span></span>
<span class="r-in"><span><span class="va">generate_flu_season</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">start</span> <span class="op">=</span> <span class="fl">1</span>, <span class="va">end</span> <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">random_increasing_obs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">24</span>, min <span class="op">=</span> <span class="va">start</span>, max <span class="op">=</span> <span class="va">end</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">random_decreasing_obs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">random_increasing_obs</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Generate peak numbers</span></span></span>
<span class="r-in"><span>  <span class="va">add_to_max</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">100</span>, <span class="fl">200</span>, <span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">peak</span> <span class="op">&lt;-</span> <span class="va">add_to_max</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">random_increasing_obs</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Combine into a single observations sequence</span></span></span>
<span class="r-in"><span>  <span class="va">observations</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">random_increasing_obs</span>, <span class="va">peak</span>, <span class="va">random_decreasing_obs</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">observations</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">season_1</span> <span class="op">&lt;-</span> <span class="fu">generate_flu_season</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">season_2</span> <span class="op">&lt;-</span> <span class="fu">generate_flu_season</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">start_date</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2022-05-29"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">end_date</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2024-05-20"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">weekly_dates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.Date.html" class="external-link">seq.Date</a></span><span class="op">(</span>from <span class="op">=</span> <span class="va">start_date</span>,</span></span>
<span class="r-in"><span>                         to <span class="op">=</span> <span class="va">end_date</span>,</span></span>
<span class="r-in"><span>                         by <span class="op">=</span> <span class="st">"week"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">tsd_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="to_time_series.html">to_time_series</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  cases <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">season_1</span>, <span class="va">season_2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="va">weekly_dates</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Print seasonal burden results</span></span></span>
<span class="r-in"><span><span class="fu">seasonal_burden_levels</span><span class="op">(</span><span class="va">tsd_data</span>, family <span class="op">=</span> <span class="st">"lnorm"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $season</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2023/2024"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $values</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   very low        low     medium       high </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   20.00000   77.96614  303.93594 1184.83559 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $optim</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $optim$par</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 6.97243417 0.06378995</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $optim$obj_value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 33.83526</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $optim$converged</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $optim$high_conf_level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.95</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $optim$family</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "lnorm"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $disease_threshold</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $incidence_denominator</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "tsd_burden_levels"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"time_interval")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "weeks"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"incidence_denominator")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] NA</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Sofia Myrup Otero, Kasper Schou Telkamp, Lasse Engbo Christiansen, <a href="https://www.ssi.dk/" class="external-link"><img src="https://www.ssi.dk/assets/images/ssi-logo-optimeret.svg" alt="SSI" height="16" style="margin-bottom: 3px;"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

