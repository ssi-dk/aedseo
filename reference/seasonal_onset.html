<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Automated and Early Detection of Seasonal Epidemic Onset — seasonal_onset • aedseo</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Automated and Early Detection of Seasonal Epidemic Onset — seasonal_onset"><meta name="description" content="This function performs automated and early detection of seasonal epidemic onsets on a tsd object.
It estimates growth rates and calculates the average sum of cases in consecutive time intervals (k).
If the time series data includes population it will be used as offset to adjust the growth rate in the glm,
additionally the output will include incidence, population and average sum of incidence."><meta property="og:description" content="This function performs automated and early detection of seasonal epidemic onsets on a tsd object.
It estimates growth rates and calculates the average sum of cases in consecutive time intervals (k).
If the time series data includes population it will be used as offset to adjust the growth rate in the glm,
additionally the output will include incidence, population and average sum of incidence."><meta property="og:image" content="https://ssi-dk.github.io/aedseo/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">aedseo</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/aedseo.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/burden_levels.html">Seasonal Burden Levels</a></li>
    <li><a class="dropdown-item" href="../articles/generate_seasonal_wave.html">Simulate Seasonal Epidemic Waves</a></li>
    <li><a class="dropdown-item" href="../articles/multiple_waves.html">Multiple waves</a></li>
    <li><a class="dropdown-item" href="../articles/seasonal_onset.html">Seasonal Epidemic Onset</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ssi-dk/aedseo/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Automated and Early Detection of Seasonal Epidemic Onset</h1>
      <small class="dont-index">Source: <a href="https://github.com/ssi-dk/aedseo/blob/v1.0.0/R/seasonal_onset.R" class="external-link"><code>R/seasonal_onset.R</code></a></small>
      <div class="d-none name"><code>seasonal_onset.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function performs automated and early detection of seasonal epidemic onsets on a <code>tsd</code> object.
It estimates growth rates and calculates the average sum of cases in consecutive time intervals (<code>k</code>).
If the time series data includes <code>population</code> it will be used as offset to adjust the growth rate in the glm,
additionally the output will include incidence, population and average sum of incidence.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">seasonal_onset</span><span class="op">(</span></span>
<span>  <span class="va">tsd</span>,</span>
<span>  k <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  disease_threshold <span class="op">=</span> <span class="cn">NA_real_</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"quasipoisson"</span>, <span class="st">"poisson"</span><span class="op">)</span>,</span>
<span>  na_fraction_allowed <span class="op">=</span> <span class="fl">0.4</span>,</span>
<span>  season_start <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  season_end <span class="op">=</span> <span class="va">season_start</span> <span class="op">-</span> <span class="fl">1</span>,</span>
<span>  only_current_season <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-tsd">tsd<a class="anchor" aria-label="anchor" href="#arg-tsd"></a></dt>
<dd><p>A <code>tsd</code> object containing time series data</p></dd>


<dt id="arg-k">k<a class="anchor" aria-label="anchor" href="#arg-k"></a></dt>
<dd><p>An integer specifying the window size for modeling growth rates and average sum of cases.</p></dd>


<dt id="arg-level">level<a class="anchor" aria-label="anchor" href="#arg-level"></a></dt>
<dd><p>The confidence level for onset parameter estimates, a numeric value between 0 and 1.</p></dd>


<dt id="arg-disease-threshold">disease_threshold<a class="anchor" aria-label="anchor" href="#arg-disease-threshold"></a></dt>
<dd><p>A number specifying the threshold for considering a disease outbreak. Should be given as incidence if
<code>population</code> and <code>incidence_denominator</code> are in the <code>tsd</code> object else as cases. It defines the per time-step disease threshold that has to be surpassed to possibly trigger a seasonal
onset alarm. If the average observation count in a window of size k exceeds <code>disease_threshold</code>, a seasonal
onset alarm can be triggered.</p></dd>


<dt id="arg-family">family<a class="anchor" aria-label="anchor" href="#arg-family"></a></dt>
<dd><p>A character string specifying the family for modeling. Choose between 'poisson', or 'quasipoisson'.
Must be one of: character, family-generator, or family object.</p></dd>


<dt id="arg-na-fraction-allowed">na_fraction_allowed<a class="anchor" aria-label="anchor" href="#arg-na-fraction-allowed"></a></dt>
<dd><p>Numeric value between 0 and 1 specifying the fraction of observations in the window
of size k that are allowed to be NA or zero, i.e. without cases, in onset calculations.</p></dd>


<dt id="arg-season-start-season-end">season_start, season_end<a class="anchor" aria-label="anchor" href="#arg-season-start-season-end"></a></dt>
<dd><p>Integers giving the start and end weeks of the seasons to
stratify the observations by. If set to <code>NULL</code>, it means no stratification by season.</p></dd>


<dt id="arg-only-current-season">only_current_season<a class="anchor" aria-label="anchor" href="#arg-only-current-season"></a></dt>
<dd><p>Should the output only include results for the current season?</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>tsd_onset</code> object containing:</p><ul><li><p>'reference_time': The time point for which the growth rate is estimated.</p></li>
<li><p>'cases': The cases at reference time point.</p></li>
<li><p>'population': The population at reference time point.</p></li>
<li><p>'incidence': The incidence at reference time point.</p></li>
<li><p>'season': The stratification of observables in corresponding seasons.</p></li>
<li><p>'growth_rate': The estimated growth rate.</p></li>
<li><p>'lower_growth_rate': The lower bound of the growth rate's confidence interval.</p></li>
<li><p>'upper_growth_rate': The upper bound of the growth rate's confidence interval.</p></li>
<li><p>'growth_warning': Logical. Is the growth rate significantly higher than zero?</p></li>
<li><p>'average_observation_window': The average of cases or incidence within the time window.</p></li>
<li><p>'average_observation_warning': Logical. Does the average observations exceed the disease threshold?</p></li>
<li><p>'seasonal_onset_alarm': Logical. Is there a seasonal onset alarm?</p></li>
<li><p>'skipped_window': Logical. Was the window skipped due to missing observations?</p></li>
<li><p>'converged': Logical. Was the IWLS judged to have converged?</p></li>
<li><p>'seasonal_onset': Logical. The first detected seasonal onset in the season.</p></li>
<li><p>Attributes: <code>time_interval</code> and <code>incidence_denominator</code>.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Create a tibble object from sample data</span></span></span>
<span class="r-in"><span><span class="va">tsd_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="to_time_series.html">to_time_series</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  cases <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">120</span>, <span class="fl">150</span>, <span class="fl">180</span>, <span class="fl">220</span>, <span class="fl">270</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2023-01-01"</span><span class="op">)</span>, by <span class="op">=</span> <span class="st">"1 week"</span>, length.out <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Estimate seasonal onset with a 3-day window</span></span></span>
<span class="r-in"><span><span class="fu">seasonal_onset</span><span class="op">(</span></span></span>
<span class="r-in"><span>  tsd <span class="op">=</span> <span class="va">tsd_data</span>,</span></span>
<span class="r-in"><span>  k <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>  level <span class="op">=</span> <span class="fl">0.975</span>,</span></span>
<span class="r-in"><span>  disease_threshold <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>  na_fraction_allowed <span class="op">=</span> <span class="fl">0.4</span>,</span></span>
<span class="r-in"><span>  season_start <span class="op">=</span> <span class="fl">21</span>,</span></span>
<span class="r-in"><span>  season_end <span class="op">=</span> <span class="fl">20</span>,</span></span>
<span class="r-in"><span>  only_current_season <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 4 × 15</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   reference_time cases season population incidence growth_rate lower_growth_rate</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> 2023-01-15       150 2022/… <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>              0.204             0.178</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> 2023-01-22       180 2022/… <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>              0.201             0.175</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> 2023-01-29       220 2022/… <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>              0.192             0.180</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> 2023-02-05       270 2022/… <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>              0.203             0.200</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 8 more variables: upper_growth_rate &lt;dbl&gt;, growth_warning &lt;lgl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   average_observations_window &lt;dbl&gt;, average_observations_warning &lt;lgl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   seasonal_onset_alarm &lt;lgl&gt;, skipped_window &lt;lgl&gt;, converged &lt;lgl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   seasonal_onset &lt;lgl&gt;</span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Sofia Myrup Otero, Kasper Schou Telkamp, Lasse Engbo Christiansen, <a href="https://www.ssi.dk/" class="external-link"><img src="https://www.ssi.dk/assets/images/ssi-logo-optimeret.svg" alt="SSI" height="16" style="margin-bottom: 3px;"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

