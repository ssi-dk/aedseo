<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Automated Detection of Seasonal Epidemic Onset and Burden Levels in R • aedseo</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Automated Detection of Seasonal Epidemic Onset and Burden Levels in R">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">aedseo</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/aedseo.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/burden_levels.html">Seasonal Burden Levels</a></li>
    <li><a class="dropdown-item" href="../articles/generate_seasonal_wave.html">Simulate Seasonal Epidemic Waves</a></li>
    <li><a class="dropdown-item" href="../articles/seasonal_onset.html">Seasonal Epidemic Onset</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ssi-dk/aedseo/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Automated Detection of Seasonal Epidemic Onset and Burden Levels in R</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ssi-dk/aedseo/blob/master/vignettes/aedseo.Rmd" class="external-link"><code>vignettes/aedseo.Rmd</code></a></small>
      <div class="d-none name"><code>aedseo.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ssi-dk/aedseo" class="external-link">aedseo</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The <code>aedseo</code> package performs automated and early
detection of seasonal epidemic onsets and estimates the breakpoints for
burden levels from time series data stratified by season. The seasonal
onset (<code><a href="../reference/seasonal_onset.html">seasonal_onset()</a></code>) estimates growth rates for
consecutive time intervals and calculates the sum of cases. The burden
levels (<code><a href="../reference/seasonal_burden_levels.html">seasonal_burden_levels()</a></code>) use the previous seasons
to estimate the burden levels of the current season. The algorithm
allows for surveillance of pathogens, by alarming when the observations
have significant growth in the selected time interval and based on the
disease-specific threshold, while also evaluating the burden of current
observations based on previous seasons.</p>
<div class="section level3">
<h3 id="seasonal-data">Seasonal data<a class="anchor" aria-label="anchor" href="#seasonal-data"></a>
</h3>
<p>To apply the <code>aedseo</code> algorithm, data needs to be
transformed into a <code>tsd</code> object. If you have your own data,
the <code><a href="../reference/to_time_series.html">to_time_series()</a></code> function can be used with the
arguments: <code>observation</code>, <code>time</code>,
<code>time_interval</code>. In the following section, the application of
the algorithm is shown with simulated data created with the
<code><a href="../reference/generate_seasonal_data.html">generate_seasonal_data()</a></code>function. More information about
the function can be found in the
<code><a href="../articles/generate_seasonal_wave.html">vignette("generate_seasonal_wave")</a></code></p>
<p>In the following figure simulated data (solid circles) are visualised
as individual observations. The solid line connects these points,
representing the underlying mean trend over three years of weekly
data.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">tsd_data</span><span class="op">)</span></span></code></pre></div>
<p><img src="aedseo_files/figure-html/unnamed-chunk-3-1.png" width="2187.5"></p>
</div>
<div class="section level3">
<h3 id="determining-season">Determining season<a class="anchor" aria-label="anchor" href="#determining-season"></a>
</h3>
<p>Respiratory viruses can circulate in different seasons based on the
location. In the nordic hemisphere they mostly circulate in the fall and
winter seasons, hence surveillance is intensified from week 40 to week
20 in the following year. To include all data, the season in the example
is set from week 21 to week 20 in the following year. In this example
burden levels and seasonal onset will be estimated for season
<em>2024/2025</em>.</p>
</div>
<div class="section level3">
<h3 id="determining-the-disease-specific-threshold">Determining the disease specific threshold<a class="anchor" aria-label="anchor" href="#determining-the-disease-specific-threshold"></a>
</h3>
<p>When observations are low there is a risk that randomness will result
in significant growth estimates in isolated periods. To increase the
robustness of the method a disease-specific threshold is introduced. It
should be set such that subsequent estimates of growth are likely to be
significant as well. The disease-specific threshold can be determined by
examining continuous periods with sustained significant growth, and
determine at what number of observations these events occur.</p>
<p>In this example the disease-specific threshold is determined based on
consecutive significant observations from all available previous
seasons. Significant observations are defined as those with a
significant positive growth rate.</p>
<p>To capture short-term changes and fluctuations in the data, a rolling
window of size
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mn>5</mn></mrow><annotation encoding="application/x-tex">k = 5</annotation></semantics></math>
is used to create subsets of the data for model fitting, and the
<code>quasipoisson</code> family is used to account for
overdispersion.</p>
<p>The disease-specific threshold will be estimated with the four
available previous seasons. The <code><a href="../reference/seasonal_onset.html">seasonal_onset()</a></code> function
can be used for this purpose, without providing the disease-specific
threshold. Then the <code><a href="../reference/consecutive_growth_warnings.html">consecutive_growth_warnings()</a></code> function
can be used to create groups with subsequent significant observations.
The data can then be analysed, else you can use plot/autoplot to
visualise the sequences of significant observations for each season.</p>
<p>The <code>sum_of_cases</code> variable is divided by five to
represent an average over a five-week window, defining the
disease-specific threshold for each time-step.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tsd_onset</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/seasonal_onset.html">seasonal_onset</a></span><span class="op">(</span></span>
<span>  tsd <span class="op">=</span> <span class="va">tsd_data</span>,</span>
<span>  k <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"quasipoisson"</span>,</span>
<span>  na_fraction_allowed <span class="op">=</span> <span class="fl">0.4</span>,</span>
<span>  season_start <span class="op">=</span> <span class="fl">21</span>, <span class="co"># Season starts in week 21</span></span>
<span>  season_end <span class="op">=</span> <span class="fl">20</span>, <span class="co"># Season ends in week 20 the following year</span></span>
<span>  only_current_season <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">consecutive_gr_warn</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/consecutive_growth_warnings.html">consecutive_growth_warnings</a></span><span class="op">(</span></span>
<span>  onset_output <span class="op">=</span> <span class="va">tsd_onset</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/autoplot.html">autoplot</a></span><span class="op">(</span></span>
<span>  <span class="va">consecutive_gr_warn</span>,</span>
<span>  k <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  skip_current_season <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">25</span>, linetype <span class="op">=</span> <span class="st">"Threshold"</span><span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"black"</span>, linewidth <span class="op">=</span> <span class="fl">0.6</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_linetype_manual</a></span><span class="op">(</span></span>
<span>    name   <span class="op">=</span> <span class="st">""</span>,</span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Threshold"</span> <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="aedseo_files/figure-html/unnamed-chunk-4-1.png" width="2187.5"></p>
<p>From the plot above, we observe the length of periods with subsequent
significant growth rates (y-axis). The season with the longest
consecutive period of growth is <em>2021/2022</em>, lasting 14 weeks.
However, since we are determining a threshold specifically for the
<em>2024/2025</em> season, it’s important to prioritize the most recent
seasons. The <em>2023/2024</em> season shows two periods of significant
growth, with the first being the longest and coinciding closely in
timing with the consecutive growth period observed in
<em>2022/2023</em>. We select a disease-specific threshold of 25 to
ensure early detection of the seasonal onset while minimizing false
positives.</p>
<p>In other words, a season onset is declared when the average
observation count over five weeks surpasses 25 and is accompanied by a
significantly positive growth rate.</p>
<p>Inspect the exact conditions around each detected season start</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">consecutive_gr_warn</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">significant_counter</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">season</span> <span class="op">!=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">consecutive_gr_warn</span><span class="op">$</span><span class="va">season</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">season</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">significant_counter</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">significant_counter</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>disease_threshold <span class="op">=</span> <span class="va">sum_of_cases</span> <span class="op">/</span> <span class="fl">5</span>,</span>
<span>                week <span class="op">=</span> <span class="fu">ISOweek</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ISOweek/man/ISOweek.html" class="external-link">ISOweek</a></span><span class="op">(</span><span class="va">reference_time</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">season</span>, <span class="va">week</span>, <span class="va">disease_threshold</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 3</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   season [4]</span></span></span>
<span><span class="co">#&gt;   season    week     disease_threshold</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 2020/2021 2020-W46              69.8</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 2021/2022 2021-W41              22.6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 2022/2023 2022-W42              28.2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 2023/2024 2023-W41              19.6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 2023/2024 2023-W48             128.</span></span></code></pre></div>
<p>By inspecting the output from the above code, the disease-specific
threshold is established at <code>25</code> observations.</p>
</div>
</div>
<div class="section level2">
<h2 id="applying-the-main-algorithm">Applying the main algorithm<a class="anchor" aria-label="anchor" href="#applying-the-main-algorithm"></a>
</h2>
<p>The primary function of the <code>aedseo</code> package is the
<code><a href="../reference/combined_seasonal_output.html">combined_seasonal_output()</a></code> which integrates the
<code><a href="../reference/seasonal_onset.html">seasonal_onset()</a></code> and <code><a href="../reference/seasonal_burden_levels.html">seasonal_burden_levels()</a></code>
functions to deliver a comprehensive seasonal analysis. Detailed
information about each function and their respective arguments can be
found in the <code><a href="../articles/seasonal_onset.html">vignette("seasonal_onset")</a></code> and
<code><a href="../articles/burden_levels.html">vignette("burden_levels")</a></code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">seasonal_output</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/combined_seasonal_output.html">combined_seasonal_output</a></span><span class="op">(</span></span>
<span>  tsd <span class="op">=</span> <span class="va">tsd_data</span>,</span>
<span>  disease_threshold <span class="op">=</span> <span class="fl">25</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"intensity_levels"</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"quasipoisson"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The default function estimates onset and burden levels for the
current season. If it is desired to see calculations for all previous
seasons, the <code>only_current_season</code> argument should be set to
<code>FALSE</code>. <em>Note: </em>Burden levels can not be estimated
for the first season and needs at least two seasons of data as the
estimations are based on data from previous seasons.\</p>
<p>The <code>aedseo</code> package implements S3 methods including the
<code><a href="../reference/plot.html">plot()</a></code>, <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code> and <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code>
functions specifically designed for objects of the <code>aedseo</code>
package. <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code> is only relevant for
<code>tsd_onset</code> objects. An example of using the
<code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> S3 method with <code>tsd_onset</code> and
<code>tsd_burden_level</code> objects is shown here.</p>
<p>Seasonal onset output can be extracted by:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">seasonal_output</span><span class="op">$</span><span class="va">onset_output</span><span class="op">)</span></span>
<span><span class="co">#&gt; Summary of tsd_onset object with disease_threshold</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;       Model output:</span></span>
<span><span class="co">#&gt;         Reference time point (first seasonal onset alarm in season): 2024-11-03</span></span>
<span><span class="co">#&gt;         Observations at reference time point: 131</span></span>
<span><span class="co">#&gt;         Sum of observations at reference time point: 329</span></span>
<span><span class="co">#&gt;         Growth rate estimate at reference time point:</span></span>
<span><span class="co">#&gt;           Estimate   Lower (2.5%)   Upper (97.5%)</span></span>
<span><span class="co">#&gt;             0.312     0.517          0.117</span></span>
<span><span class="co">#&gt;         Total number of growth warnings in the series: 11</span></span>
<span><span class="co">#&gt;         Latest growth warning: 2024-12-22</span></span>
<span><span class="co">#&gt;         Latest sum of cases warning: 2025-01-26</span></span>
<span><span class="co">#&gt;         Latest seasonal onset alarm: 2024-12-22</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;       The season for reference time point:</span></span>
<span><span class="co">#&gt;         2024/2025</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;       Model settings:</span></span>
<span><span class="co">#&gt;         Called using distributional family: quasipoisson</span></span>
<span><span class="co">#&gt;         Window size for growth rate estimation and calculation of sum of cases: 5</span></span>
<span><span class="co">#&gt;         The time interval for the observations: week</span></span>
<span><span class="co">#&gt;         Disease specific threshold: 25</span></span></code></pre></div>
<p>Seasonal burden output can be extracted by:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">seasonal_output</span><span class="op">$</span><span class="va">burden_output</span><span class="op">)</span></span>
<span><span class="co">#&gt; Summary of tsd_burden_levels object</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     Breakpoint estimates:</span></span>
<span><span class="co">#&gt;       very low : 25.000000</span></span>
<span><span class="co">#&gt;       low: 61.188227</span></span>
<span><span class="co">#&gt;       medium: 149.759965</span></span>
<span><span class="co">#&gt;       high: 366.541871</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     The season for the burden levels:</span></span>
<span><span class="co">#&gt;       2024/2025</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     Model settings:</span></span>
<span><span class="co">#&gt;       Disease specific threshold: 25</span></span>
<span><span class="co">#&gt;       Called using distributional family: lnorm</span></span></code></pre></div>
<div class="section level3">
<h3 id="plot-the-comprehensive-seasonal-analysis">Plot the comprehensive seasonal analysis<a class="anchor" aria-label="anchor" href="#plot-the-comprehensive-seasonal-analysis"></a>
</h3>
<p>The <code><a href="../reference/plot.html">plot()</a></code> S3 method for
<code>tsd_combined_seasonal_output</code> objects allows you to get a
complete visualisation of the <code><a href="../reference/combined_seasonal_output.html">combined_seasonal_output()</a></code>
analysis of the current season.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Adjust y_lower_bound dynamically to remove noisy small values</span></span>
<span><span class="va">disease_threshold</span> <span class="op">&lt;-</span> <span class="fl">25</span></span>
<span><span class="va">y_lower_bound</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">disease_threshold</span> <span class="op">&lt;</span> <span class="fl">10</span>, <span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">seasonal_output</span>,</span>
<span>  y_lower_bound <span class="op">=</span> <span class="va">y_lower_bound</span>,</span>
<span>  time_interval <span class="op">=</span> <span class="st">"3 weeks"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="aedseo_files/figure-html/unnamed-chunk-9-1.png" width="2187.5"></p>
<p>Using the <code>intensity_levels</code> method to define burden
levels, the seasonal onset is likely to fall within the <code>low</code>
or <code>medium</code> category. This is because the
<code>very low</code> breakpoint is the disease-specific threshold, and
season onset is only identified if the five-week average of the
observations exceed this threshold along with a significant positive
growth rate.</p>
</div>
<div class="section level3">
<h3 id="investigate-historical-estimates">Investigate historical estimates<a class="anchor" aria-label="anchor" href="#investigate-historical-estimates"></a>
</h3>
<p>The <code><a href="../reference/historical_summary.html">historical_summary()</a></code> function for
<code>tsd_onset</code> objects provides historical estimates from all
previous seasons. By utilising this function, it is easy to assess
whether current estimates align with previously observed patterns for a
specific pathogen, or if significant changes have occurred. Such changes
might result from altered testing practices, pathogen mutations, or
other factors.</p>
<p>If the analysis indicates notable deviations from past patterns, it
is advisable to revisit the method used to define the disease-specific
threshold, as it might need some adjustment.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get `tsd_onset` object</span></span>
<span><span class="va">tsd_onset</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/seasonal_onset.html">seasonal_onset</a></span><span class="op">(</span></span>
<span>  tsd <span class="op">=</span> <span class="va">tsd_data</span>,</span>
<span>  disease_threshold <span class="op">=</span> <span class="fl">25</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"quasipoisson"</span>,</span>
<span>  season_start <span class="op">=</span> <span class="fl">21</span>,</span>
<span>  season_end <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  only_current_season <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/historical_summary.html">historical_summary</a></span><span class="op">(</span><span class="va">tsd_onset</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 10</span></span></span>
<span><span class="co">#&gt;   season    onset_time peak_time  peak_intensity lower_growth_rate_onset</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 2020/2021 2020-11-15 2021-01-10            275                 0.006<span style="text-decoration: underline;">81</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 2021/2022 2021-10-24 2022-01-09            292                 0.155  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 2022/2023 2022-10-23 2022-12-25            287                 0.412  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 2023/2024 2023-10-22 2024-01-07            377                 0.501  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 2024/2025 2024-11-03 2025-01-12            331                 0.117  </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 5 more variables: growth_rate_onset &lt;dbl&gt;, upper_growth_rate_onset &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   onset_week &lt;dbl&gt;, peak_week &lt;dbl&gt;, weeks_to_peak &lt;dbl&gt;</span></span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Sofia Myrup Otero, Kasper Schou Telkamp, Lasse Engbo Christiansen, <a href="https://www.ssi.dk/" class="external-link"><img src="https://www.ssi.dk/assets/images/ssi-logo-optimeret.svg" alt="SSI" height="16" style="margin-bottom: 3px;"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
