<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="aedseo">
<title>Automated Detection of Seasonal Epidemic Onset in R • aedseo</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Automated Detection of Seasonal Epidemic Onset in R">
<meta property="og:description" content="aedseo">
<meta property="og:image" content="https://telkamp7.github.io/aedseo/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">aedseo</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/aedseo.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/aedseo_introduction.html">Automated Detection of Seasonal Epidemic Onset in R</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/telkamp7/aedseo/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Automated Detection of Seasonal Epidemic Onset in R</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/telkamp7/aedseo/blob/HEAD/vignettes/aedseo_introduction.Rmd" class="external-link"><code>vignettes/aedseo_introduction.Rmd</code></a></small>
      <div class="d-none name"><code>aedseo_introduction.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/telkamp7/aedseo" class="external-link">aedseo</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette …</p>
<p>The methodology used to detect the onset of seasonal respiratory
epidemics can be divided into two essential criteria:</p>
<ul>
<li>The local estimate of the exponential growth rate, <span class="math inline">\(r\)</span>, is significantly greater than
zero.</li>
<li>The sum of cases (SoC) over the past <span class="math inline">\(k\)</span> units of time exceeds a
disease-specific threshold.</li>
</ul>
<p>Here, <span class="math inline">\(k\)</span> denotes the window size
employed to obtain the local estimate of the exponential growth rate and
the SoC. When both of these criteria are met, an alarm is triggered and
the onset of the seasonal epidemic is detected.</p>
</div>
<div class="section level2">
<h2 id="simulations">Simulations<a class="anchor" aria-label="anchor" href="#simulations"></a>
</h2>
<p>To assess the effectiveness of the <code>aedseo</code> function, we
simulate some data. The simulated data is generated using a negative
binomial model with a mean parameter <span class="math inline">\(\mu\)</span> and a variance parameter <span class="math inline">\(\phi\mu\)</span>. In this context <span class="math inline">\(\phi\)</span> denotes a dispersion parameter,
which is assumed to be greater than or equal to 1. The mean, denoted as
<span class="math inline">\(\mu(t)\)</span>, is defined by a linear
predictor that incorporates both a trend component and seasonality
components represented by Fourier terms. The equation <span class="math inline">\(\mu(t)\)</span> is as follows:</p>
<p><span class="math display">\[\begin{equation}
  \mu(t) = \exp\Biggl( \theta + \beta t + \sum_{j=1}^m \biggl(
\gamma_{\sin} \sin\Bigl( \frac{2 \pi t}{52}\Bigl) + \gamma_{\cos} \cos
\Bigl( \frac{2 \pi t}{52} \Bigl) \biggl) \Biggl)
\end{equation}\]</span></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mu_t</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span></span>
<span>    <span class="va">t</span>,</span>
<span>    <span class="va">theta</span> <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    <span class="va">exp_beta</span> <span class="op">=</span> <span class="fl">1.001</span>,</span>
<span>    <span class="va">gamma_sin</span> <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    <span class="va">gamma_cos</span> <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    <span class="va">trend</span> <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    <span class="va">j</span> <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Start construction of linear predictor</span></span>
<span>  <span class="va">linear_predictor</span> <span class="op">&lt;-</span> <span class="va">theta</span></span>
<span>  <span class="co"># ... add a trend if the scenario request it</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">trend</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">linear_predictor</span> <span class="op">&lt;-</span> <span class="va">linear_predictor</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">exp_beta</span><span class="op">)</span> <span class="op">*</span> <span class="va">t</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="co"># ... add a seasonal component</span></span>
<span>  <span class="va">linear_predictor</span> <span class="op">&lt;-</span> <span class="va">linear_predictor</span> <span class="op">+</span></span>
<span>    <span class="va">gamma_sin</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">pi</span> <span class="op">*</span> <span class="va">t</span> <span class="op">*</span> <span class="va">j</span> <span class="op">/</span> <span class="fl">52</span><span class="op">)</span> <span class="op">+</span> <span class="va">gamma_cos</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">cos</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">pi</span> <span class="op">*</span> <span class="va">t</span> <span class="op">*</span> <span class="va">j</span> <span class="op">/</span> <span class="fl">52</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">linear_predictor</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">simulate_from_nbinom</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Set some default values for the simulation</span></span>
<span>  <span class="va">default_pars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"t"</span> <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    <span class="st">"theta"</span> <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    <span class="st">"exp_beta"</span> <span class="op">=</span> <span class="fl">1.001</span>,</span>
<span>    <span class="st">"gamma_sin"</span> <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    <span class="st">"gamma_cos"</span> <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    <span class="st">"trend"</span> <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    <span class="st">"j"</span> <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    <span class="st">"phi"</span> <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    <span class="st">"seed"</span> <span class="op">=</span> <span class="fl">42</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Match call</span></span>
<span>  <span class="va">mc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/match.call.html" class="external-link">match.call</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="co"># ... and change parameters relative to the call</span></span>
<span>  <span class="va">index_mc</span> <span class="op">&lt;-</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">default_pars</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">mc</span><span class="op">)</span></span>
<span>  <span class="va">mc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span><span class="op">(</span><span class="va">mc</span>, <span class="va">default_pars</span><span class="op">[</span><span class="va">index_mc</span><span class="op">]</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">default_pars</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span>  <span class="co"># Set the seed</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="va">mc</span><span class="op">$</span><span class="va">seed</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Calculate the number of time points</span></span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/eval.html" class="external-link">eval</a></span><span class="op">(</span><span class="va">mc</span><span class="op">$</span><span class="va">t</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="co"># Calculate mu_t</span></span>
<span>  <span class="va">mu_t_scenario</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span>what <span class="op">=</span> <span class="st">"mu_t"</span>, args <span class="op">=</span> <span class="va">mc</span><span class="op">)</span></span>
<span>  <span class="co"># ... and compute the variance of the negative binomial distribution</span></span>
<span>  <span class="va">variance</span> <span class="op">&lt;-</span> <span class="va">mu_t_scenario</span> <span class="op">*</span> <span class="va">mc</span><span class="op">$</span><span class="va">phi</span></span>
<span>  <span class="co"># ... and infer the size in the negative binomial distribution</span></span>
<span>  <span class="va">size</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">mu_t_scenario</span> <span class="op">+</span> <span class="va">mu_t_scenario</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="va">variance</span></span>
<span>  <span class="co"># Plugin and simulate the data</span></span>
<span>  <span class="va">simulation</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/NegBinomial.html" class="external-link">rnbinom</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n</span>, mu <span class="op">=</span> <span class="va">mu_t_scenario</span>, size <span class="op">=</span> <span class="va">size</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"mu_t"</span> <span class="op">=</span> <span class="va">mu_t_scenario</span>, <span class="st">"simulation"</span> <span class="op">=</span> <span class="va">simulation</span>, <span class="st">"pars"</span> <span class="op">=</span> <span class="va">mc</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Define the number of years and the number of months within a year</span></span>
<span><span class="va">years</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">weeks</span> <span class="op">&lt;-</span> <span class="fl">52</span></span>
<span><span class="co"># ... calculate the total number of observations</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="va">years</span> <span class="op">*</span> <span class="va">weeks</span></span>
<span><span class="co"># ... and a vector containing the overall time passed</span></span>
<span><span class="va">time_overall</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="va">n</span></span>
<span><span class="co"># Create arbitrary dates</span></span>
<span><span class="va">dates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">time_overall</span> <span class="op">*</span> <span class="fl">86400</span> <span class="op">*</span> <span class="fl">7</span>,</span>
<span>  origin <span class="op">=</span> <span class="st">"2010-01-01"</span>,</span>
<span>  tz <span class="op">=</span> <span class="st">"UTC"</span>,</span>
<span>  format <span class="op">=</span> <span class="st">"%F"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Simulate the data</span></span>
<span><span class="va">simulation</span> <span class="op">&lt;-</span> <span class="fu">simulate_from_nbinom</span><span class="op">(</span>t <span class="op">=</span> <span class="va">time_overall</span>, theta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span>, phi <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Collect the data in a 'tibble'</span></span>
<span><span class="va">sim_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  Date <span class="op">=</span> <span class="va">dates</span>,</span>
<span>  mu_t <span class="op">=</span> <span class="va">simulation</span><span class="op">$</span><span class="va">mu_t</span>,</span>
<span>  y <span class="op">=</span> <span class="va">simulation</span><span class="op">$</span><span class="va">simulation</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>A total of three years of weekly data are then simulated with the
following set of parameters:</p>
<ul>
<li>
<span class="math inline">\(\theta=\log(1000)\)</span>, representing
an average intensity of 1000 cases.</li>
<li>
<span class="math inline">\(\exp(\beta)=1.001\)</span>, indicating a
slowly increasing trend.</li>
<li>
<span class="math inline">\(\gamma_{\sin} = 1\)</span> and <span class="math inline">\(\gamma_{\cos} = 1\)</span>, representing the
seasonality component.</li>
<li>
<span class="math inline">\(\phi = 5\)</span>, which represents the
dispersion parameter for the negative binomial distribution.</li>
</ul>
<p>In the following figure, the simulated data (solid circles) is
visualized alongside the mean (solid line) for the three arbitrary years
of weekly data.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Have a glance at the time varying mean and the simulated data</span></span>
<span><span class="va">sim_data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Date</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">mu_t</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="aedseo_introduction_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="applying-the-algorithm">Applying the algorithm<a class="anchor" aria-label="anchor" href="#applying-the-algorithm"></a>
</h2>
<p>In the following section, the application of the algorithm to the
simulated data is outlined. The first step is to transform the simulated
data into a <code>aedseo_tsd</code> object using the <code><a href="../reference/tsd.html">tsd()</a></code>
function.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Construct an 'aedseo_tsd' object with the time series data</span></span>
<span><span class="va">tsd_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tsd.html">tsd</a></span><span class="op">(</span></span>
<span>  observed <span class="op">=</span> <span class="va">simulation</span><span class="op">$</span><span class="va">simulation</span>,</span>
<span>  time <span class="op">=</span> <span class="va">dates</span>,</span>
<span>  time_interval <span class="op">=</span> <span class="st">"week"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Next, the time series data object is passed to the
<code><a href="../reference/aedseo.html">aedseo()</a></code> function. Here, a window width of <span class="math inline">\(k=5\)</span> is specified, meaning that a total of
5 weeks is used in the local estimate of the exponential growth rate.
Additionally, a 95% confidence interval is specified. Finally, the
exponential growth rate is estimated using quasi-Poisson regression to
account for overdispersion in the data.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Apply the 'aedseo' algorithm</span></span>
<span><span class="va">aedseo_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/aedseo.html">aedseo</a></span><span class="op">(</span></span>
<span>  tsd <span class="op">=</span> <span class="va">tsd_data</span>,</span>
<span>  k <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"quasipoisson"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>In the figure below, the observed values from the simulations is
visualized alongside the local estimate of the growth rate and its
corresponding 95% confidence interval.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Join the observations and estimated growth rates</span></span>
<span><span class="va">full_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">full_join</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">tsd_data</span>,</span>
<span>  y <span class="op">=</span> <span class="va">aedseo_results</span>,</span>
<span>  by <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/join_by.html" class="external-link">join_by</a></span><span class="op">(</span><span class="st">"time"</span> <span class="op">==</span> <span class="st">"reference_time"</span>, <span class="st">"observed"</span> <span class="op">==</span> <span class="st">"observed"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Data to add horizontal line in growth rate</span></span>
<span><span class="va">ablines</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"growth_rate"</span>, <span class="st">"observed"</span><span class="op">)</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Make a nice plot</span></span>
<span><span class="va">full_data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">observed</span>, <span class="va">growth_rate</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">tsd_data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"observed"</span><span class="op">)</span>,</span>
<span>    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">observed</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">aedseo_results</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"growth_rate"</span><span class="op">)</span>,</span>
<span>    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">reference_time</span>,</span>
<span>      ymin <span class="op">=</span> <span class="va">lower_growth_rate</span>,</span>
<span>      ymax <span class="op">=</span> <span class="va">upper_growth_rate</span></span>
<span>    <span class="op">)</span>,</span>
<span>    inherit.aes <span class="op">=</span> <span class="cn">FALSE</span>, alpha <span class="op">=</span> <span class="fl">0.3</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">ablines</span>,</span>
<span>    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="va">x</span><span class="op">)</span>,</span>
<span>    linetype <span class="op">=</span> <span class="st">"dashed"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span>facets <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">name</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">1</span>, scale <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 4 rows containing missing values (`geom_line()`).</span></span>
<span><span class="co">#&gt; Warning: Removed 1 rows containing missing values (`geom_hline()`).</span></span></code></pre></div>
<p><img src="aedseo_introduction_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Kasper Schou Telkamp.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
