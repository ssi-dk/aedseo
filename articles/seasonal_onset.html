<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Seasonal Epidemic Onset • aedseo</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Seasonal Epidemic Onset">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">aedseo</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/aedseo.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/burden_levels.html">Seasonal Burden Levels</a></li>
    <li><a class="dropdown-item" href="../articles/generate_seasonal_wave.html">Simulate Seasonal Epidemic Waves</a></li>
    <li><a class="dropdown-item" href="../articles/multiple_waves.html">Multiple waves</a></li>
    <li><a class="dropdown-item" href="../articles/seasonal_onset.html">Seasonal Epidemic Onset</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ssi-dk/aedseo/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Seasonal Epidemic Onset</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ssi-dk/aedseo/blob/v1.0.1/vignettes/seasonal_onset.Rmd" class="external-link"><code>vignettes/seasonal_onset.Rmd</code></a></small>
      <div class="d-none name"><code>seasonal_onset.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ssi-dk/aedseo" class="external-link">aedseo</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="methodology">Methodology<a class="anchor" aria-label="anchor" href="#methodology"></a>
</h2>
<p>The methodology used to detect the seasonal onset of epidemics, can
be divided into two essential criteria:</p>
<ol style="list-style-type: decimal">
<li>The local estimate of the exponential growth rate,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>r</mi><annotation encoding="application/x-tex">r</annotation></semantics></math>,
is significantly greater than zero.</li>
<li>The average observation count over the past
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
units of time exceeds a disease-specific threshold.</li>
</ol>
<p>Here,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
denotes the window size employed to obtain the local estimate of the
exponential growth rate and SoC. When both of these criteria are met, an
alarm is triggered and the onset of the seasonal epidemic is
detected.</p>
<p>The model is implemented in the <code><a href="../reference/seasonal_onset.html">seasonal_onset()</a></code>
function of the <code>aedseo</code> package. Criteria one is fulfilled
if the <code>growth_warning</code> in the output is <code>TRUE</code>.
Criteria two is fulfilled if the
<code>average_observation_warning</code> in the output is
<code>TRUE</code>.</p>
<div class="section level3">
<h3 id="exponential-growth-rate">Exponential growth rate<a class="anchor" aria-label="anchor" href="#exponential-growth-rate"></a>
</h3>
<p>The exponential growth rate, denoted as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>r</mi><annotation encoding="application/x-tex">r</annotation></semantics></math>,
represents the per capita change in the number of new cases per unit of
time. Given that number of cases are integer-valued, the proposed method
relies on generalized linear models (GLM). For count data, the Poisson
distribution is a suitable choice as a model. Hence, the cases denoted
as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Y</mi><annotation encoding="application/x-tex">Y</annotation></semantics></math>
are assumed to follow a Poisson distribution</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mo>∼</mo><mrow><mi mathvariant="normal">P</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">s</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>λ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\begin{equation}
 Y \sim \mathrm{Pois}(\lambda)
\end{equation}</annotation></semantics></math></p>
<p>Here, the link function,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\log()</annotation></semantics></math>,
connects the linear predictor to the expected value of the data point,
expressed as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>λ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>μ</mi></mrow><annotation encoding="application/x-tex">\log(\lambda)=\mu</annotation></semantics></math>.
Given a single continuous covariate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>,
the mean
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>μ</mi><annotation encoding="application/x-tex">\mu</annotation></semantics></math>
can be expressed as</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>μ</mi><mo>=</mo><mi>α</mi><mo>+</mo><mi>r</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">\begin{equation}
  \mu = \alpha + r t
\end{equation}</annotation></semantics></math></p>
<p>This is equivalent to a multiplicative model for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>,
i.e.</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi><mo>=</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>α</mi><mo>+</mo><mi>r</mi><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>α</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>r</mi><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\begin{equation}
  \lambda = \exp(\alpha + r t) = \exp(\alpha) \exp(r t)
\end{equation}</annotation></semantics></math></p>
<p>Intuitively, negative values of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>r</mi><annotation encoding="application/x-tex">r</annotation></semantics></math>
result in a decline in the number of observed cases, while
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">r=0</annotation></semantics></math>
represents stability, and positive values of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>r</mi><annotation encoding="application/x-tex">r</annotation></semantics></math>
indicate an increase.</p>
<p>It is important to note that the Poisson distribution assumes that
the mean and variance are equal. In reality, real data often deviate
from this assumption, with the variance
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>v</mi><annotation encoding="application/x-tex">v</annotation></semantics></math>)
being significantly larger than the mean. This biological phenomenon,
known as overdispersion, can be addressed within a model in various
ways. One approach is to employ quasi-Poisson regression, which assumes
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi><mo>=</mo><mi>σ</mi><mi>λ</mi></mrow><annotation encoding="application/x-tex">v=\sigma\lambda</annotation></semantics></math>,
or to use negative binomial regression (not implemented yet), which
assumes
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi><mo>=</mo><mi>λ</mi><mo>+</mo><msup><mi>λ</mi><mn>2</mn></msup><mi>/</mi><mi>θ</mi></mrow><annotation encoding="application/x-tex">v=\lambda+\lambda^2/\theta</annotation></semantics></math>,
where both
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>σ</mi><annotation encoding="application/x-tex">\sigma</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>
are overdispersion parameters.</p>
<p>If the background population changes during the time-span for the
cases, the growth rate estimations can be adjusted by applying
population as offset in the model.</p>
</div>
</div>
<div class="section level2">
<h2 id="applying-the-seasonal_onset-algorithm">Applying the seasonal_onset algorithm<a class="anchor" aria-label="anchor" href="#applying-the-seasonal_onset-algorithm"></a>
</h2>
<p>First we generate cases in a <code>tsd</code> object, with the
<code><a href="../reference/generate_seasonal_data.html">generate_seasonal_data()</a></code> function.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Construct an 'tsd' object with time series data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">222</span><span class="op">)</span></span>
<span><span class="va">tsd_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_seasonal_data.html">generate_seasonal_data</a></span><span class="op">(</span></span>
<span>  years <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  start_date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2020-10-18"</span><span class="op">)</span>,</span>
<span>  trend_rate <span class="op">=</span> <span class="fl">1.002</span>,</span>
<span>  noise_overdispersion <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  relative_epidemic_concentration <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  time_interval <span class="op">=</span> <span class="st">"weeks"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Next, the <code>tsd</code> object is passed to the
<code><a href="../reference/seasonal_onset.html">seasonal_onset()</a></code> function. Here, a window size of
<code>k=5</code> is specified, meaning that a total of 5 weeks is used
in the local estimate of the exponential growth rate.
<code>na_fraction_allowed = 0.4</code> defines how large a fraction of
cases in the <code>k</code> window that are allowed to be
<code>NA</code>, here <code>0.4*5 = 2</code> cases. Additionally, a 95%
confidence interval is specified. Finally, the exponential growth rate
is estimated using quasi-Poisson regression to account for
overdispersion in the data. A disease-specific threshold can
additionally be passed to the function, but is not necessary if only the
growth rate estimations are wanted. <code>season_start</code> and
<code>season_end</code> can be used to specify the season to stratify
the cases by. This algorithm runs across seasons, such that the first
cases in a new season will use the last <code>k-1</code> cases from the
previous season. The <code><a href="../reference/seasonal_onset.html">seasonal_onset()</a></code> function provides a
<code>tsd_onset</code> object with a comprehensive seasonal onset
analysis.</p>
<p><em>NOTE: </em>As default the output is in cases, but if
<code>incidence</code> and <code>population</code> is in the
<code>tsd</code> object the average observations will be in incidence
and the model will use <code>population</code> as offset in each time
point.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">seasonal_onset_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/seasonal_onset.html">seasonal_onset</a></span><span class="op">(</span></span>
<span>  tsd <span class="op">=</span> <span class="va">tsd_data</span>,</span>
<span>  k <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  disease_threshold <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"quasipoisson"</span>,</span>
<span>  season_start <span class="op">=</span> <span class="fl">21</span>,</span>
<span>  season_end <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  only_current_season <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="visualising-growth-rates">Visualising Growth Rates<a class="anchor" aria-label="anchor" href="#visualising-growth-rates"></a>
</h2>
<p>In the first figure, cases over time are shown with a legend for the
seasonal onset alarm. In the second figure, the local estimates of the
growth rates are presented along with their corresponding 95% confidence
interval with a legend for the growth warning. This visualisation can be
generated by utilizing the <code><a href="../reference/plot.html">plot()</a></code> S3 method with objects of
the <code>tsd_onset</code> class.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">seasonal_onset_results</span><span class="op">)</span></span></code></pre></div>
<p><img src="seasonal_onset_files/figure-html/unnamed-chunk-4-1.png" class="r-plt" width="2187.5"><img src="seasonal_onset_files/figure-html/unnamed-chunk-4-2.png" class="r-plt" width="2187.5"></p>
</div>
<div class="section level2">
<h2 id="predicting-growth-rates">Predicting Growth Rates<a class="anchor" aria-label="anchor" href="#predicting-growth-rates"></a>
</h2>
<p>The <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code> S3 method for <code>tsd_onset</code>
objects allows you to make predictions for future time steps based on
the estimated growth rates. Following is an example of predicted cases
for the next 5 weekly time steps.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prediction</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">seasonal_onset_results</span>, n_step <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<p><img src="seasonal_onset_files/figure-html/unnamed-chunk-6-1.png" class="r-plt" width="700"></p>
<p>In the example above, we use the predict method to predict growth
rates for the next 5 time steps, according to the
<code>time_interval = "week"</code> in the <code>tsd_onset</code>
object. The <code>n_step</code> argument specifies the number of steps
into the future you want to forecast. The resulting
<code>tsd_predict</code> object contains case estimates, lower bounds,
and upper bounds for each time step.</p>
</div>
<div class="section level2">
<h2 id="summarising-seasonal_onset-results">Summarising seasonal_onset results<a class="anchor" aria-label="anchor" href="#summarising-seasonal_onset-results"></a>
</h2>
<p>The <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> S3 method for <code>tsd_onset</code>
objects provides a concise summary of your automated early detection of
<code>seasonal_onset</code> analysis. You can use it to retrieve
important information about your analysis, including the first seasonal
onset alarm (reference time point), SoC at reference time point (here
over a 5 week window), growth rate estimates at reference time point,
total number of growth warnings in the series and latest warnings
(growth and SoC). It helps you quickly assess the key findings of your
analysis.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">seasonal_onset_results</span><span class="op">)</span></span>
<span><span class="co">#&gt; Summary of tsd_onset object with disease_threshold</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;       Model output:</span></span>
<span><span class="co">#&gt;         Reference time point (first seasonal onset alarm in season): 2023-09-24</span></span>
<span><span class="co">#&gt;         Observations at reference time point: 38</span></span>
<span><span class="co">#&gt;         Average observations (in k window) at reference time point: 20.4</span></span>
<span><span class="co">#&gt;         Growth rate estimate at reference time point:</span></span>
<span><span class="co">#&gt;           Estimate   Lower (2.5%)   Upper (97.5%)</span></span>
<span><span class="co">#&gt;             0.391     0.596          0.199</span></span>
<span><span class="co">#&gt;         Total number of growth warnings in the series: 52</span></span>
<span><span class="co">#&gt;         Latest growth warning: 2023-10-08</span></span>
<span><span class="co">#&gt;         Latest average observations warning: 2023-10-08</span></span>
<span><span class="co">#&gt;         Latest seasonal onset alarm: 2023-10-08</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;       The season for reference time point:</span></span>
<span><span class="co">#&gt;         2023/2024</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;       Model settings:</span></span>
<span><span class="co">#&gt;         Called using distributional family: quasipoisson</span></span>
<span><span class="co">#&gt;         Window size: 5</span></span>
<span><span class="co">#&gt;         The time interval for the observations: weeks</span></span>
<span><span class="co">#&gt;         Disease specific threshold: 20</span></span>
<span><span class="co">#&gt;         Incidence denominator: NA</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Sofia Myrup Otero, Kasper Schou Telkamp, Lasse Engbo Christiansen, <a href="https://www.ssi.dk/" class="external-link"><img src="https://www.ssi.dk/assets/images/ssi-logo-optimeret.svg" alt="SSI" height="16" style="margin-bottom: 3px;"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
